$(document).ready(function(){function e(t){const a=$(t);a.length&&a.DataTable({responsive:!0,pagingType:"simple",paging:!0,order:[]})}e("#myTable");var c=localStorage.getItem("selectedView")||"grid";c==="grid"?u():n(),$("#grid-view-btn").on("click",function(){u(),localStorage.setItem("selectedView","grid")}),$("#table-view-btn").on("click",function(){n(),localStorage.setItem("selectedView","list")});function u(){$("#grid-view").removeClass("hidden"),$(".grid-view-btn").removeClass("hidden"),$(".table-view").addClass("hidden"),$("#grid-view-btn").addClass("text-red-900 dark:text-[#CCAA2C]").removeClass("text-gray-300"),$("#table-view-btn").addClass("text-gray-500").removeClass("text-red-900 dark:text-[#CCAA2C]")}function n(){$(".table-view").removeClass("hidden"),$(".grid-view-btn").addClass("hidden"),$("#grid-view").addClass("hidden"),$("#table-view-btn").addClass("text-red-900 dark:text-[#CCAA2C]").removeClass("text-gray-300"),$("#grid-view-btn").addClass("text-gray-500").removeClass("text-red-900 dark:text-[#CCAA2C]")}$("#create-new").on("click",function(){$("#initial-options").addClass("hidden"),$("#record-type-options").removeClass("hidden"),$("#classrecord-information").addClass("hidden"),$("#normal-grade-configuration").addClass("hidden"),$("#header").removeClass("hidden"),$("#p-add-classrecord").addClass("hidden"),$("#p-type-classrecord").removeClass("hidden")}),$("#create-btn, #create-btn2").on("click",function(){$("#modal").removeClass("hidden"),$("#classrecord-information").removeClass("hidden"),$("#p-classrecord").removeClass("hidden"),$("#normal-grade-configuration").addClass("hidden"),$("#header").removeClass("hidden"),$("body").addClass("no-scroll")}),$("#normal-classrecord, #special-classrecord").on("click",function(){$("#classrecord-information").removeClass("hidden"),$("#p-type-classrecord").addClass("hidden"),$("#p-classrecord").removeClass("hidden"),$("#record-type-options").addClass("hidden"),$("#normal-grade-configuration").addClass("hidden"),$("#header").addClass("hidden")}),$("#close-btn, #header-close-btn").on("click",function(){$("#modal").addClass("hidden"),$("body").removeClass("no-scroll")}),$("#use-template").on("click",function(){$("#initial-options").addClass("hidden"),$("#record-type-options").removeClass("hidden"),$("#classrecord-information").addClass("hidden"),$("#normal-grade-configuration").addClass("hidden")}),$("#midterm, #final-back-btn").on("click",function(){$("#final-grade").addClass("hidden"),$("#midterm-grade").removeClass("hidden"),$("#finals").removeClass("hidden").removeClass("text-red-900"),$("#midterm").addClass("text-red-900"),$("#special-grade").addClass("hidden");const t=document.querySelectorAll(".step-number"),a=document.querySelectorAll(".step-border");t.length>=4&&a.length>=3&&(t[3].classList.add("bg-gray-300","text-gray-500"),t[3].classList.remove("bg-red-900","text-white"),a[2].classList.remove("bg-red-900"),a[2].classList.add("bg-gray-200"))}),$("#finals").on("click",function(){$("#final-grade").removeClass("hidden"),$("#midterm-grade").addClass("hidden"),$("#finals").removeClass("hidden").addClass("text-red-900"),$("#midterm").removeClass("text-red-900"),$("#special-grade").addClass("hidden")}),$("#edit-midterm, #edit-final-back-btn").on("click",function(){$("#edit-final-grade").addClass("hidden"),$("#edit-midterm-grade").removeClass("hidden"),$("#edit-finals").removeClass("hidden").removeClass("text-red-900"),$("#edit-midterm").addClass("text-red-900"),$("#edit-special-grade").addClass("hidden");const t=document.querySelectorAll(".step-number"),a=document.querySelectorAll(".step-border");t.length>=4&&a.length>=3&&(t[3].classList.add("bg-gray-300","text-gray-500"),t[3].classList.remove("bg-red-900","text-white"),a[2].classList.remove("bg-red-900"),a[2].classList.add("bg-gray-200"))}),$("#edit-finals").on("click",function(){$("#edit-final-grade").removeClass("hidden"),$("#edit-midterm-grade").addClass("hidden"),$("#edit-finals").removeClass("hidden").addClass("text-red-900"),$("#edit-midterm").removeClass("text-red-900"),$("#edit-special-grade").addClass("hidden")}),$(".modify-btn").on("click",function(){$(this).siblings(".modify-record").toggleClass("hidden")}),$(document).on("click",function(t){$(t.target).closest(".modify-btn, .modify-record").length||$(".modify-record").addClass("hidden")}),$("#back-btn").on("click",function(){$("#classrecord-information").addClass("hidden"),$("#record-type-options").removeClass("hidden"),$("#p-classrecord").addClass("hidden"),$("#p-type-classrecord").removeClass("hidden")}),$("#midterm-back-btn").on("click",function(){$("#grade-distribution").removeClass("hidden"),$("#classrecord-information").addClass("hidden"),$("#normal-grade-configuration").addClass("hidden");const t=document.querySelectorAll(".step-number"),a=document.querySelectorAll(".step-border");t.length>=3&&a.length>=2&&(t[2].classList.add("bg-gray-300","text-gray-500"),t[2].classList.remove("bg-red-900","text-white"),a[1].classList.remove("bg-red-900"),a[1].classList.add("bg-gray-200"),t[1].classList.remove("bg-gray-300","text-gray-500"),t[1].classList.add("bg-red-900","text-white"))}),$("#special-back-btn").on("click",function(){$("#final-grade").removeClass("hidden"),$("#classrecord-information").addClass("hidden"),$("#special-grade").addClass("hidden");const t=document.querySelectorAll(".step-number"),a=document.querySelectorAll(".step-border");t.length>=4&&a.length>=3&&(t[4].classList.add("bg-gray-300","text-gray-500"),t[4].classList.remove("bg-red-900","text-white"),a[3].classList.remove("bg-red-900"),a[3].classList.add("bg-gray-200"))}),$("#edit-special-back-btn").on("click",function(){$("#edit-final-grade").removeClass("hidden"),$("#classrecord-information").addClass("hidden"),$("#edit-special-grade").addClass("hidden");const t=document.querySelectorAll(".step-number"),a=document.querySelectorAll(".step-border");t.length>=4&&a.length>=3&&(t[4].classList.add("bg-gray-300","text-gray-500"),t[4].classList.remove("bg-red-900","text-white"),a[3].classList.remove("bg-red-900"),a[3].classList.add("bg-gray-200"))}),$("#edit-midterm-back-btn, #special-edit-back-btn").on("click",function(){$("#edit-grade-distribution").removeClass("hidden"),$("#edit-classrecord-information").addClass("hidden"),$("#edit-normal-grade-configuration").addClass("hidden");const t=document.querySelectorAll(".step-number"),a=document.querySelectorAll(".step-border");t.length>=3&&a.length>=2&&(t[2].classList.add("bg-gray-300","text-gray-500"),t[2].classList.remove("bg-red-900","text-white"),a[1].classList.remove("bg-red-900"),a[1].classList.add("bg-gray-200"),t[1].classList.remove("bg-gray-300","text-gray-500"),t[1].classList.add("bg-red-900","text-white"))}),$("#grade-config-back-btn").on("click",function(){$("#grade-distribution").addClass("hidden"),$("#classrecord-information").removeClass("hidden"),$("#next-btn").removeClass("hidden");const t=$('[data-step="1"] .step-number'),a=$('[data-step="2"] .step-number');$(".step-border").removeClass("bg-red-900").addClass("bg-gray-200"),a.removeClass("bg-red-900 text-white").addClass("bg-gray-300 text-gray-500"),t.removeClass("bg-gray-300 text-gray-500").addClass("bg-red-900 text-white")}),$("#edit-grade-config-back-btn").on("click",function(){$("#edit-grade-distribution").addClass("hidden"),$("#edit-classrecord-information").removeClass("hidden"),$("#edit-final-grade").removeClass("hidden"),$("#edit-header-grade-configuration").removeClass("hidden"),$("#editfinals").removeClass("hidden").removeClass("text-red-900"),$("#edit-special-grade").addClass("hidden"),$("#edit-next-btn").removeClass("hidden");const t=$('[data-step="1"] .step-number'),a=$('[data-step="2"] .step-number');$(".step-border").removeClass("bg-red-900").addClass("bg-gray-200"),a.removeClass("bg-red-900 text-white").addClass("bg-gray-300 text-gray-500"),t.removeClass("bg-gray-300 text-gray-500").addClass("bg-red-900 text-white")})});function I(e=!1){const c=e?"edit-":"",u=$(`.${c}first-grade-type-input`).val(),n=$(`.${c}second-grade-type-input`).val(),t=$(`.${c}third-grade-type-input`).val();$(`#${c}grading-period-1 p`).text(u||"1st Grading"),$(`#${c}grading-period-2 p`).text(n||"2nd Grading"),$(`#${c}grading-period-3 p`).text(t||"3rd Grading"),$(`#${c}midterm-name`).text((u||"Midterm")+" Grade Percentage"),$(`#${c}final-name`).text((n||"Finals")+" Grade Percentage"),$(`#${c}special-name`).text((t||"Special")+" Grade Percentage")}$(".first-grade-type-input, .second-grade-type-input, .third-grade-type-input").on("keyup change",function(){I(!1)});$(".edit-first-grade-type-input, .edit-second-grade-type-input, .edit-third-grade-type-input").on("keyup change",function(){I(!0)});$(document).ready(function(){function e(n=!1){const t=n?"edit-":"",a=$(`#${t}grading-period`).val();$(`#${t}first-grading, #${t}second-grading, #${t}third-grading`).addClass("hidden"),a==="1"?($(`#${t}first-grading`).removeClass("hidden"),$(`#${t}grading-period-1`).removeClass("hidden")):a==="2"?($(`#${t}first-grading, #${t}second-grading`).removeClass("hidden"),$(`#${t}grading-period-1, #${t}grading-period-2`).removeClass("hidden")):a==="3"&&($(`#${t}first-grading, #${t}second-grading, #${t}third-grading`).removeClass("hidden"),$(`#${t}grading-period-1, #${t}grading-period-2, #${t}grading-period-3`).removeClass("hidden")),$(`#${t}total-grade-distribution`).text("Total: 0%")}$("#grading-period").on("change",function(){e(!1)}),$("#edit-grading-period").on("change",function(){e(!0)});function c(n,t=!1){const a=t?"edit-":"",d=parseInt($(`.${a}first-grade-distribution-input`).val())||0,l=parseInt($(`.${a}second-grade-distribution-input`).val())||0,o=parseInt($(`.${a}third-grade-distribution-input`).val())||0;let s=0;return n==="1"?s=d:n==="2"?s=d+l:n==="3"&&(s=d+l+o),$(`#${a}total-grade-distribution`).text("Total: "+s+"%"),s>100&&Swal.fire({icon:"error",title:"Oops...",text:"Total Grading Distribution Percentage exceeds 100%. Please adjust the values!"}),s}function u(n,t=!1){const a=t?"edit-":"",d=$(`.${a}first-grade-type-input`).val(),l=parseInt($(`.${a}first-grade-distribution-input`).val())||0,o=$(`.${a}second-grade-type-input`).val(),s=parseInt($(`.${a}second-grade-distribution-input`).val())||0,i=$(`.${a}third-grade-type-input`).val(),r=parseInt($(`.${a}third-grade-distribution-input`).val())||0;let p=!0;return n==="1"&&(!d||l===0)?(Swal.fire({icon:"error",title:"Input Error",text:"Please fill in the 1st Grading Name and Percentage!"}),p=!1):n==="2"&&(!d||l===0||!o||s===0)?(Swal.fire({icon:"error",title:"Input Error",text:"Please fill in the 1st and 2nd Grading Name and Percentage!"}),p=!1):n==="3"&&(!d||l===0||!o||s===0||!i||r===0)&&(Swal.fire({icon:"error",title:"Input Error",text:"Please fill in the 1st, 2nd, and 3rd Grading Name and Percentage!"}),p=!1),p}$(".first-grade-distribution-input, .second-grade-distribution-input, .third-grade-distribution-input").on("input",function(){const n=$("#grading-period").val();c(n,!1)}),$(".edit-first-grade-distribution-input, .edit-second-grade-distribution-input, .edit-third-grade-distribution-input").on("input",function(){const n=$("#edit-grading-period").val();c(n,!0)}),$("#grade-config-next-btn").on("click",function(n){const t=$("#grading-period").val(),a=c(t,!1);if(!u(t,!1)){n.preventDefault();return}if(a!==100){Swal.fire({icon:"error",title:"Percentage Error",text:"The total grading percentage must equal 100%."}),n.preventDefault();return}document.getElementById("header-grade-configuration").classList.remove("hidden"),document.getElementById("normal-grade-configuration").classList.remove("hidden"),document.getElementById("grade-distribution").classList.add("hidden");const d=document.querySelectorAll(".step-number"),l=document.querySelectorAll(".step-border");d.length>=3&&l.length>=2&&(d[1].classList.remove("bg-gray-300","text-gray-500"),d[1].classList.add("bg-red-900","text-white"),l[1].classList.remove("bg-gray-200"),l[1].classList.add("bg-red-900"),d[2].classList.remove("bg-gray-300","text-gray-500"),d[2].classList.add("bg-red-900","text-white"))}),$("#edit-grade-config-next-btn").on("click",function(n){const t=$("#edit-grading-period").val(),a=c(t,!0);if(!u(t,!0)){n.preventDefault();return}if(a!==100){Swal.fire({icon:"error",title:"Percentage Error",text:"The total grading percentage must equal 100%."}),n.preventDefault();return}document.getElementById("edit-header-grade-configuration").classList.remove("hidden"),document.getElementById("edit-normal-grade-configuration").classList.remove("hidden"),document.getElementById("edit-grade-distribution").classList.add("hidden"),document.getElementById("edit-final-grade").classList.add("hidden"),document.getElementById("edit-special-grade").classList.add("hidden");const d=document.querySelectorAll(".step-number"),l=document.querySelectorAll(".step-border");d.length>=3&&l.length>=2&&(d[1].classList.remove("bg-gray-300","text-gray-500"),d[1].classList.add("bg-red-900","text-white"),l[1].classList.remove("bg-gray-200"),l[1].classList.add("bg-red-900"),d[2].classList.remove("bg-gray-300","text-gray-500"),d[2].classList.add("bg-red-900","text-white"))}),I(!1),I(!0)});$(document).ready(function(){function e(o,s=!1){const i=s?"edit-":"";$(`#${i}midterm-next-btn`).addClass("hidden"),$(`#${i}final-next-btn`).addClass("hidden"),$(`#${i}special-next-btn`).addClass("hidden"),$(`#${i}submit-btn`).addClass("hidden"),o==="1"?($(`.${i}midterm-submit`).removeClass("hidden"),$(`#${i}midterm-next-btn`).addClass("hidden")):o==="2"?($(`#${i}midterm-next-btn`).removeClass("hidden"),$(`.${i}midterm-submit`).addClass("hidden"),$(`.${i}final-submit`).removeClass("hidden")):o==="3"&&($(`.${i}midterm-submit`).addClass("hidden"),$(`.${i}final-submit`).addClass("hidden"),$(`#${i}midterm-next-btn`).removeClass("hidden"),$(`#${i}final-next-btn`).removeClass("hidden"),$(`#${i}special-submit`).removeClass("hidden"))}$("#grading-period").on("change",function(){const o=$(this).val();e(o,!1),c(o)}),$("#edit-grading-period").on("change",function(){const o=$(this).val();e(o,!0)});function c(o){const s=$("#applyAll");o==="1"?s.parent().hide():s.parent().show()}$("#applyAll").on("change",function(){const o=$(this).prop("checked"),s=$("#grading-period").val();function i(){let r=0;return $(".class-standing-input, .examination-input").each(function(){const p=parseFloat($(this).val())||0;r+=p}),r}if(o){if(i()!==100){Swal.fire({icon:"error",title:"Invalid Percentage",text:"The total percentage must equal 100. Please adjust the values."}),$(this).prop("checked",!1);return}n(s),$(this).prop("disabled",!0)}});function u(o,s,i){const r=`
            <div class="flex items-center space-x-1 mb-2 gap-2">
                <input type="text" 
                       class="md:w-1/3 w-1/2 border-b border-black focus:outline-none assessment-type-input text-black pl-2" 
                       value="${s}">
                <span>:</span>
                <input type="number" 
                       class="text-center border-b border-black focus:outline-none w-20 grade-input-finals text-black final-${o}-input ${o}-input" 
                       min="0" max="100" value="0">
                <span>%</span>
            </div>
        `;if($(`#final-${o}-container`).append(r),t("final"),i==="3"){const p=`
                <div class="flex items-center space-x-1 mb-2 gap-2">
                    <input type="text" 
                           class=" border-b border-black focus:outline-none md:w-1/3 w-1/2 assessment-type-input text-black pl-2" 
                           value="${s}">
                    <span>:</span>
                    <input type="number" 
                           class="text-center border-b border-black focus:outline-none w-20 grade-input-special text-black special-${o}-input ${o}-input" 
                           min="0" max="100" value="0">
                    <span>%</span>
                </div>
            `;$(`#special-${o}-container`).append(p),t("special")}}function n(o){$("#final-class-standing-percentage").val($("#class-standing-percentage").val()),$("#special-class-standing-percentage").val($("#class-standing-percentage").val()),$("#class-standing-container .class-standing-input").each(function(s){const i=$(this),r=i.prevAll("input[type='text']").val(),p=i.val();s>=$("#final-class-standing-container .final-class-standing-input").length&&u("class-standing",r,o),$("#final-class-standing-container .final-class-standing-input").eq(s).val(p),$("#final-class-standing-container input[type='text']").eq(s).val(r),o==="3"&&($("#special-class-standing-container .special-class-standing-input").eq(s).val(p),$("#special-class-standing-container input[type='text']").eq(s).val(r))}),$("#final-examination-percentage").val($("#examination-percentage").val()),$("#special-examination-percentage").val($("#examination-percentage").val()),$("#examination-container .examination-input").each(function(s){const i=$(this),r=i.prevAll("input[type='text']").val(),p=i.val();s>=$("#final-examination-container .final-examination-input").length&&u("examination",r,o),$("#final-examination-container .final-examination-input").eq(s).val(p),$("#final-examination-container input[type='text']").eq(s).val(r),o==="3"&&($("#special-examination-container .special-examination-input").eq(s).val(p),$("#special-examination-container input[type='text']").eq(s).val(r))}),t("final"),o==="3"&&t("special")}function t(o){const s=$(`#${o}-examination-percentage`),i=$(`#${o}-class-standing-percentage`);let r=0;$(`.${o}-class-standing-input`).each(function(){r+=parseFloat($(this).val())||0});const p=$(`.total-class-standing-${o}-input`);p.val(r);let g=0;$(`.${o}-examination-input`).each(function(){g+=parseFloat($(this).val())||0});const m=$(`.total-${o}-examination-input`);m.val(g);const h=parseFloat(i.val())||0,f=parseFloat(s.val())||0,b=Math.abs(r-h)<.01,v=Math.abs(g-f)<.01;x(i[0],b),x(s[0],v),x(p[0],b),x(m[0],v)}$("#edit-applyAll").on("change",function(){const o=$(this).prop("checked"),s=$("#edit-grading-period").val();function i(){let r=0;return $(".class-standing-input, .examination-input").each(function(){const p=parseFloat($(this).val())||0;r+=p}),r}if(o){const r=i();if(r!==100){Swal.fire({icon:"error",title:"Invalid Percentage",text:"The total percentage must equal 100. Please adjust the values."+r}),$(this).prop("checked",!1);return}d(s),$(this).prop("disabled",!0)}});function a(o,s,i){const r=`
            <div class="flex items-center space-x-1 mb-2 gap-2">
                <input type="text" 
                       class="md:w-1/3 w-1/2 border-b border-black focus:outline-none assessment-type-input text-black pl-2" 
                       value="${s}">
                <span>:</span>
                <input type="number" 
                       class="text-center border-b border-black focus:outline-none w-20 edit-grade-input-finals text-black edit-final-${o}-input ${o}-input" 
                       min="0" max="100" value="0">
                <span>%</span>
            </div>
        `;if($(`#edit-final-${o}-container`).append(r),l("final"),i==="3"){const p=`
                <div class="flex items-center space-x-1 mb-2 gap-2">
                    <input type="text" 
                           class="border-b border-black focus:outline-none md:w-1/3 w-1/2 assessment-type-input text-black pl-2" 
                           value="${s}">
                    <span>:</span>
                    <input type="number" 
                           class="text-center border-b border-black focus:outline-none w-20 edit-grade-input-special text-black  edit-special-${o}-input ${o}-input" 
                           min="0" max="100" value="0">
                    <span>%</span>
                </div>
            `;$(`#edit-special-${o}-container`).append(p),l("special")}}function d(o){$("#edit-final-class-standing-percentage").val($("#edit-class-standing-percentage").val()),$("#edit-special-class-standing-percentage").val($("#edit-class-standing-percentage").val()),$("#edit-class-standing-container .class-standing-input").each(function(s){const i=$(this),r=i.prevAll("input[type='text']").val(),p=i.val();s>=$("#edit-final-class-standing-container .edit-final-class-standing-input").length&&a("class-standing",r,o),$("#edit-final-class-standing-container .edit-final-class-standing-input").eq(s).val(p),$("#edit-final-class-standing-container input[type='text']").eq(s).val(r),o==="3"&&($("#edit-special-class-standing-container .edit-special-class-standing-input").eq(s).val(p),$("#edit-special-class-standing-container input[type='text']").eq(s).val(r))}),$("#edit-final-examination-percentage").val($("#edit-examination-percentage").val()),$("#edit-special-examination-percentage").val($("#edit-examination-percentage").val()),$("#edit-examination-container .examination-input").each(function(s){const i=$(this),r=i.prevAll("input[type='text']").val(),p=i.val();s>=$("#edit-final-examination-container .edit-final-examination-input").length&&a("examination",r,o),$("#edit-final-examination-container .edit-final-examination-input").eq(s).val(p),$("#edit-final-examination-container input[type='text']").eq(s).val(r),o==="3"&&($("#edit-special-examination-container .edit-special-examination-input").eq(s).val(p),$("#edit-special-examination-container input[type='text']").eq(s).val(r))}),l("final"),o==="3"&&l("special")}function l(o){const s=$(`#edit-${o}-examination-percentage`),i=$(`
            #edit-${o}-class-standing-percentage
        `);let r=0;$(`.edit-${o}-class-standing-input`).each(function(){r+=parseFloat($(this).val())||0});const p=$(`
            .edit-total-class-standing-${o}-input
          
        `);p.val(r);let g=0;$(`.edit-${o}-examination-input`).each(function(){g+=parseFloat($(this).val())||0});const m=$(`
            .edit-total-${o}-examination-input
        `);m.val(g);const h=parseFloat(i.val())||0,f=parseFloat(s.val())||0,b=Math.abs(r-h)<.01,v=Math.abs(g-f)<.01;x(i[0],b),x(s[0],v),x(p[0],b),x(m[0],v)}});$(document).ready(function(){$("#program-dropdown-toggle").on("click",function(){$("#filter-dropdown").toggleClass("hidden")}),$("#filter-dropdown li").on("click",function(){let e=$(this).data("filter");$("#filter-label").text(e),$("#filter-dropdown").addClass("hidden")}),$("#search-input").on("input",function(){let e=$(this).val().toLowerCase(),c=$("#filter-label").text();e===""?$("#new-class-record-container").show():$("#new-class-record-container").hide(),$(".record-item").each(function(){let u=$(this).data("title").toLowerCase(),n=$(this).data("code").toLowerCase(),t=$(this).data("program-title").toLowerCase(),a=$(this).data("program-code").toLowerCase(),d=!1;c==="All"?d=u.includes(e)||n.includes(e)||t.includes(e)||a.includes(e):c==="Program"?d=t.includes(e)||a.includes(e):c==="Course"&&(d=u.includes(e)||n.includes(e)),$(this).toggle(d)})})});$(document).ready(function(){function e(c,u){$(c).on("change",function(n){var t=new FileReader;t.onload=function(){var a=document.getElementById(u);a.src=t.result},t.readAsDataURL(n.target.files[0])})}e("#image-upload","image-preview"),e("#edit-image-upload","edit-image-preview")});document.addEventListener("DOMContentLoaded",function(){function u(n){const t=document.getElementById(n);if(t)for(let a=2023;a<=2050;a++){let d=document.createElement("option");d.value=`${a}-${a+1}`,d.textContent=`${a}-${a+1}`,t.appendChild(d)}}u("academic-year"),u("edit-academic-year")});$(document).ready(function(){function e(){$.ajax({url:"/get-branches",method:"GET",success:function(n){const t=$("#branch-select");t.empty(),t.append("<option value=''>Select PUP Branch</option>"),n.branches.forEach(function(a){t.append(`<option value="${a.branchID}">${a.branchDescription}</option>`)})},error:function(n){console.error("Error fetching branches:",n)}})}function c(n){n?$.ajax({url:`/get-program/${n}`,method:"GET",success:function(t){const a=$("#program-select");a.empty(),a.append("<option value=''>Select Program</option>"),t.programs.forEach(function(d){a.append(`<option value="${d.programID}">${d.programTitle}</option>`)})},error:function(t){console.error("Error fetching programs:",t)}}):$("#program-select").empty().append("<option value=''>Select Program</option>")}function u(n,t){$(n).on("change",function(){const a=$(this).val();$.ajax({url:`/get-courses/${a}`,method:"GET",success:function(d){const l=$(t);l.empty(),l.append("<option value=''>Select Course</option>"),d.courses.forEach(function(o){l.append(`<option value="${o.courseID}" data-course-code="${o.courseCode}">${o.courseTitle}</option>`)})},error:function(d){console.error("Error fetching courses:",d)}})}),$(t).on("change",function(){const d=$(this).find(":selected").data("course-code");$("#course-description").text(d||"Select a course")})}e(),$("#branch-select").on("change",function(){const n=$(this).val();c(n)}),u("#program-select","#course-select")});$(document).ready(function(){function e(u){$(`#${u}midterm-next-btn`).on("click",function(n){const t=u==="edit-",a=t?"edit-":"",d=S(a,!1,t),l=parseFloat($(`#${a}class-standing-percentage`).val())||0,o=parseFloat($(`#${a}examination-percentage`).val())||0;if(!d||l===0||o===0){n.preventDefault();let r="Please ensure the total percentage adds up to 100% before proceeding.";return(l===0||o===0)&&(r="Class Standing and Examination percentages must both be greater than 0."),Swal.fire({title:"Invalid Midterm Total",text:r,icon:"error",confirmButtonText:"OK"}),!1}$(`#${u}final-grade`).removeClass("hidden"),$(`#${u}midterm-grade`).addClass("hidden"),$(`#${u}finals`).removeClass("hidden").addClass("text-red-900"),$(`#${u}midterm`).removeClass("text-red-900"),$(`#${u}special-grade`).addClass("hidden");const s=document.querySelectorAll(".step-number"),i=document.querySelectorAll(".step-border");s.length>=4&&i.length>=3&&(s[2].classList.remove("bg-gray-300","text-gray-500"),s[2].classList.add("bg-red-900","text-white"),s[3].classList.remove("bg-gray-300","text-gray-500"),s[3].classList.add("bg-red-900","text-white"),i[2].classList.remove("bg-gray-200"),i[2].classList.add("bg-red-900"))})}function c(u){$(`#${u}final-next-btn`).on("click",function(n){const t=u==="edit-",a=t?"edit-":"",d=T(a,!1,t),l=parseFloat($(`#${a}final-class-standing-percentage`).val())||0,o=parseFloat($(`#${a}final-examination-percentage`).val())||0;if(!d||l===0||o===0){n.preventDefault();let r="Please ensure the total percentage adds up to 100% before proceeding.";return(l===0||o===0)&&(r="Class Standing and Examination percentages must both be greater than 0."),Swal.fire({title:"Invalid Final Total",text:r,icon:"error",confirmButtonText:"OK"}),!1}$(`#${u}special-grade`).removeClass("hidden"),$(`#${u}final-grade`).addClass("hidden"),$(`#${u}midterm-grade`).addClass("hidden"),$(`#${u}grade-distribution`).addClass("hidden");const s=document.querySelectorAll(".step-number"),i=document.querySelectorAll(".step-border");s.length>=5&&i.length>=4&&(s[3].classList.remove("bg-gray-300","text-gray-500"),s[3].classList.add("bg-red-900","text-white"),s[4].classList.remove("bg-gray-300","text-gray-500"),s[4].classList.add("bg-red-900","text-white"),i[3].classList.remove("bg-gray-200"),i[3].classList.add("bg-red-900"))})}e("edit-"),e(""),c("edit-"),c("")});function S(e,c=!1,u=!1){const n=document.getElementById(`${e}midterm-total`),t=document.getElementById(`${e}class-standing-container`),a=document.getElementById(`${e}examination-container`),d=document.querySelector(`.${e}total-grade-class-standing`),l=document.querySelector(`.${e}total-examination-input`),o=document.getElementById(`${e}class-standing-percentage`),s=document.getElementById(`${e}examination-percentage`);let i=0,r=0;const p=100;t.querySelectorAll(`.${e}grade-input:not(.examination-input)`).forEach(y=>{i+=parseFloat(y.value)||0}),a.querySelectorAll(`.${e}grade-input.examination-input`).forEach(y=>{r+=parseFloat(y.value)||0});function g(y){return y%1===0?y.toString():y.toFixed(2)}d.value=g(i),l.value=g(r);let m=parseFloat(o.value)||0,h=parseFloat(s.value)||0;c||(m===0&&(o.value=g(i),m=i),h===0&&(s.value=g(r),h=r));const f=m+h,b=p-f;n.textContent=`Total: ${g(b)}%`;const v=Math.abs(f-p)<.01,C=Math.abs(i-m)<.01,w=Math.abs(r-h)<.01;return i>m?(Swal.fire({title:"Error",text:`Total Class Standing (${g(i)}) exceeds the assigned percentage (${g(m)}).`,icon:"error",confirmButtonText:"OK"}),!1):r>h?(Swal.fire({title:"Error",text:`Total Examination (${g(r)}) exceeds the assigned percentage (${g(h)}).`,icon:"error",confirmButtonText:"OK"}),!1):(x(o,C),x(s,w),x(n,v),x(d,C),x(l,w),v&&C&&w)}function x(e,c){c?(e.classList.remove("border-red-500"),e.classList.add("border-green-500")):(e.classList.remove("border-green-500"),e.classList.add("border-red-500"))}function k(e,c=!1){const u=document.getElementById(`${e}class-standing-container`),n=document.getElementById(`${e}examination-container`),t=document.getElementById(`${e}class-standing-percentage`),a=document.getElementById(`${e}examination-percentage`),d=document.getElementById(`${e}add-class-standing`),l=document.getElementById(`${e}add-examination`),o=document.getElementById(`${e}new-class-standing-name`),s=document.getElementById(`${e}new-examination-name`);if(u.dataset.initialized==="true")return;function i(g,m,h,f){const b=m.value.trim();if(!b){Swal.fire({title:"Error",text:"Assessment name cannot be empty",icon:"error",confirmButtonText:"OK"});return}const v=document.createElement("div");v.className="flex items-center space-x-1 mb-2 gap-2",v.innerHTML=` 
            <input 
                type="text" 
                class="assessment-type-input text-left border-b border-black focus:outline-none w-1/3 text-black pl-2" 
                value="${b}" 
            />
            <span>:</span>
            <input 
                type="number" 
                class="text-center border-b border-black focus:outline-none w-20 text-black ${e}grade-input ${h} ${f?"examination-input":"class-standing-input"}" 
                min="0" 
                max="100" 
                value="0"
            />
            <span>%</span>
        `,g.appendChild(v),m.value="",v.querySelector("input[type='number']").addEventListener("input",()=>S(e,!1,c)),S(e,!1,c)}document.addEventListener("click",function(g){g.target===d?(g.preventDefault(),i(u,o,`${e}class-standing-input`,!1)):g.target===l&&(g.preventDefault(),i(n,s,`${e}examination-input`,!0))});function r(g){g.addEventListener("input",function(m){m.target.classList.contains(`${e}grade-input`)&&S(e,!1,c)})}function p(g){g.addEventListener("input",()=>{S(e,!0,c)})}r(u),r(n),p(t),p(a),S(e,!1,c),u.dataset.initialized="true"}$(document).ready(function(){k("",!1),k("edit-",!0)});function T(e,c=!1,u=!1){const n=document.getElementById(`${e}final-total`),t=document.getElementById(`${e}final-class-standing-container`),a=document.getElementById(`${e}final-examination-container`),d=document.querySelector(`.${e}total-class-standing-final-input`),l=document.querySelector(`.${e}total-final-examination-input`),o=document.getElementById(`${e}final-class-standing-percentage`),s=document.getElementById(`${e}final-examination-percentage`);let i=0,r=0;const p=100;t.querySelectorAll(`.${e}grade-input-finals:not(.examination-input)`).forEach(y=>{i+=parseFloat(y.value)||0}),a.querySelectorAll(`.${e}grade-input-finals.examination-input`).forEach(y=>{r+=parseFloat(y.value)||0});function g(y){return y%1===0?y.toString():y.toFixed(2)}d.value=g(i),l.value=g(r);let m=parseFloat(o.value)||0,h=parseFloat(s.value)||0;c||(m===0&&(o.value=g(i),m=i),h===0&&(s.value=g(r),h=r));const f=m+h,b=p-f;n.textContent=`Total: ${b}%`;const v=Math.abs(f-p)<.01,C=Math.abs(i-m)<.01,w=Math.abs(r-h)<.01;return x(o,C),x(s,w),x(n,v),x(d,C),x(l,w),i>m?(Swal.fire({icon:"error",title:"Error",text:`Total Class Standing (${i.toFixed(2)}) exceeds the assigned percentage (${m.toFixed(2)}).`}),!1):r>h?(Swal.fire({icon:"error",title:"Error",text:`Total Examination (${r.toFixed(2)}) exceeds the assigned percentage (${h.toFixed(2)}).`}),!1):v&&C&&w}function D(e,c=!1){const u=document.getElementById(`${e}final-class-standing-container`),n=document.getElementById(`${e}final-examination-container`),t=document.getElementById(`${e}final-class-standing-percentage`),a=document.getElementById(`${e}final-examination-percentage`),d=document.getElementById(`${e}final-add-class-standing`),l=document.getElementById(`${e}final-add-examination`),o=document.getElementById(`${e}final-new-class-standing-name`),s=document.getElementById(`${e}final-new-examination-name`);if(u.dataset.initialized==="true")return;function i(g,m,h,f){const b=m.value.trim();if(!b){Swal.fire({title:"Error",text:"Final assessment name cannot be empty",icon:"error",confirmButtonText:"OK"});return}parseFloat(document.getElementById(`${e}final-class-standing-percentage`).value),parseFloat(document.getElementById(`${e}final-examination-percentage`).value);const v=document.createElement("div");v.className="flex items-center space-x-1 mb-2 gap-2",v.innerHTML=`
            <input 
                type="text" 
                class="assessment-type-input text-left border-b border-black focus:outline-none w-1/3 text-black pl-2" 
                value="${b}" 
            />
            <span>:</span>
            <input type="number" class="text-center border-b border-black focus:outline-none w-20 text-black ${e}grade-input-finals ${h} ${f?"examination-input":""}" min="0" max="100" value="0">
            <span>%</span>
        `,g.appendChild(v),m.value="",v.querySelector("input[type='number']").addEventListener("input",()=>T(e,!1,c)),T(e,!1,c)}document.addEventListener("click",function(g){g.target===d?(g.preventDefault(),i(u,o,`${e}final-class-standing-input`,!1)):g.target===l&&(g.preventDefault(),i(n,s,`${e}final-examination-input`,!0))});function r(g){g.addEventListener("input",function(m){m.target.classList.contains(`${e}grade-input-finals`)&&T(e,!1,c)})}function p(g){g.addEventListener("input",()=>{T(e,!0,c)})}r(u),r(n),p(t),p(a),T(e,!1,c),u.dataset.initialized="true"}$(document).ready(function(){D("",!1),D("edit-",!0)});function E(e,c=!1,u=!1){const n=document.getElementById(`${e}special-total`),t=document.getElementById(`${e}special-class-standing-container`),a=document.getElementById(`${e}special-examination-container`),d=document.querySelector(`.${e}total-class-standing-special-input`),l=document.querySelector(`.${e}total-special-examination-input`),o=document.getElementById(`${e}special-class-standing-percentage`),s=document.getElementById(`${e}special-examination-percentage`);let i=0,r=0;const p=100;t.querySelectorAll(`.${e}grade-input-special:not(.examination-input)`).forEach(y=>{i+=parseFloat(y.value)||0}),a.querySelectorAll(`.${e}grade-input-special.examination-input`).forEach(y=>{r+=parseFloat(y.value)||0});function g(y){return y%1===0?y.toString():y.toFixed(2)}d.value=g(i),l.value=g(r);let m=parseFloat(o.value)||0,h=parseFloat(s.value)||0;c||(m===0&&(o.value=g(i),m=i),h===0&&(s.value=g(r),h=r));const f=m+h,b=p-f;n.textContent=`Total: ${b}%`;const v=Math.abs(f-p)<.01,C=Math.abs(i-m)<.01,w=Math.abs(r-h)<.01;return x(o,C),x(s,w),x(n,v),x(d,C),x(l,w),i>m?(Swal.fire({icon:"error",title:"Error",text:`Total Class Standing (${i.toFixed(2)}) exceeds the assigned percentage (${m.toFixed(2)}).`}),!1):r>h?(Swal.fire({icon:"error",title:"Error",text:`Total Examination (${r.toFixed(2)}) exceeds the assigned percentage (${h.toFixed(2)}).`}),!1):v&&C&&w}function B(e,c=!1){const u=document.getElementById(`${e}special-class-standing-container`),n=document.getElementById(`${e}special-examination-container`),t=document.getElementById(`${e}special-class-standing-percentage`),a=document.getElementById(`${e}special-examination-percentage`),d=document.getElementById(`${e}special-add-class-standing`),l=document.getElementById(`${e}special-add-examination`),o=document.getElementById(`${e}special-new-class-standing-name`),s=document.getElementById(`${e}special-new-examination-name`);if(u.dataset.initialized==="true")return;function i(g,m,h,f){const b=m.value.trim();if(!b){Swal.fire({title:"Error",text:"Special assessment name cannot be empty",icon:"error",confirmButtonText:"OK"});return}const v=document.createElement("div");v.className="flex items-center space-x-1 mb-2 gap-2",v.innerHTML=`
            <input 
                type="text" 
                class="assessment-type-input text-left border-b border-black focus:outline-none w-1/3 text-black pl-2" 
                value="${b}" 
            />
            <span>:</span>
            <input type="number" class="text-center border-b border-black focus:outline-none w-20 text-black  ${e}grade-input-special ${h} ${f?"examination-input":""}" min="0" max="100" value="0">
            <span>%<span>
        `,g.appendChild(v),m.value="",v.querySelector("input[type='number']").addEventListener("input",()=>E(e,!1,c)),E(e,!1,c)}document.addEventListener("click",function(g){g.target===d?(g.preventDefault(),i(u,o,`${e}special-class-standing-input`,!1)):g.target===l&&(g.preventDefault(),i(n,s,`${e}special-examination-input`,!0))});function r(g){g.addEventListener("input",function(m){m.target.classList.contains(`${e}grade-input-special`)&&E(e,!1,c)})}function p(g){g.addEventListener("input",()=>{E(e,!0,c)})}r(u),r(n),p(t),p(a),E(e,!1,c),u.dataset.initialized="true"}$(document).ready(function(){B("",!1),B("edit-",!0)});$(document).ready(function(){$("#submit-btn, #special-submit-btn").on("click",function(){const u=$("#grading-period").val();if(!u){console.error("No record type selected or it is undefined.");return}let n=0,t=0,a=0;const d=[];if(u==="1"){if(n=e(".first-grade-distribution-input"),n!==100){Swal.fire({title:"Invalid Grading Distribution",html:`The total percentage for Midterm must be 100%.<br><br>
                           Current total: ${n}%`,icon:"error",confirmButtonText:"OK"});return}d.push({gradingDistributionType:$(".first-grade-type-input").val(),gradingDistributionPercentage:n,term:1})}else if(u==="2"){if(n=e(".first-grade-distribution-input"),t=e(".second-grade-distribution-input"),n+t!==100){Swal.fire({title:"Invalid Grading Distribution",html:`The total percentage for Midterm and Finals must be 100%.<br><br>
                           Current totals:<br>
                           Midterm: ${n}%<br>
                           Finals: ${t}%`,icon:"error",confirmButtonText:"OK"});return}d.push({gradingDistributionType:$(".first-grade-type-input").val(),gradingDistributionPercentage:n,term:1},{gradingDistributionType:$(".second-grade-type-input").val(),gradingDistributionPercentage:t,term:2})}else if(u==="3"){if(n=e(".first-grade-distribution-input"),t=e(".second-grade-distribution-input"),a=e(".third-grade-distribution-input"),n+t+a!==100){Swal.fire({title:"Invalid Grading Distribution",html:`The total percentage for Midterm, Finals, and Special must be 100%.<br><br>
                           Current totals:<br>
                           Midterm: ${n}%<br>
                           Finals: ${t}%<br>
                           Special: ${a}%`,icon:"error",confirmButtonText:"OK"});return}d.push({gradingDistributionType:$(".first-grade-type-input").val(),gradingDistributionPercentage:n,term:1},{gradingDistributionType:$(".second-grade-type-input").val(),gradingDistributionPercentage:t,term:2},{gradingDistributionType:$(".third-grade-type-input").val(),gradingDistributionPercentage:a,term:3})}const l=new FormData;l.append("schoolYear",$("#academic-year").val());const o=c();l.append("schedules",JSON.stringify(o)),l.append("semester",$('select[name="semester"]').val()),l.append("yearLevel",$("#year-level").val()),l.append("classImg",$("#image-upload")[0].files[0]),l.append("template",$("#template-field").val()||""),l.append("recordType",u),l.append("programID",$("#program-select").val()),l.append("courseID",$("#course-select").val()),l.append("branch",$("#branch-select").val()),d.forEach((r,p)=>{l.append(`gradingDistributions[${p}][gradingDistributionType]`,r.gradingDistributionType),l.append(`gradingDistributions[${p}][gradingDistributionPercentage]`,r.gradingDistributionPercentage),l.append(`gradingDistributions[${p}][term]`,r.term)});const s=[];if(u==="1"){if(e(".grade-input")!==100){Swal.fire({title:"Error!",text:"total percentage must equal 100%.",icon:"error",confirmButtonText:"OK"});return}i(".grade-input",1,"#class-standing-container","#examination-container")}else if(u==="2"){const r=e(".grade-input"),p=e(".grade-input-finals");if(r!==100||p!==100){Swal.fire({title:"Error!",text:"total percentages must equal 100%.",icon:"error",confirmButtonText:"OK"});return}i(".grade-input",1,"#class-standing-container","#examination-container"),i(".grade-input-finals",2,"#final-class-standing-container","#final-examination-container")}else if(u==="3"){const r=e(".grade-input"),p=e(".grade-input-finals"),g=e(".grade-input-special");if(r!==100||p!==100||g!==100){Swal.fire({title:"Error!",text:"total percentages must equal 100%.",icon:"error",confirmButtonText:"OK"});return}i(".grade-input",1,"#class-standing-container","#examination-container"),i(".grade-input-finals",2,"#final-class-standing-container","#final-examination-container"),i(".grade-input-special",3,"#special-class-standing-container","#special-examination-container")}function i(r,p,g,m){$(r).each(function(){const h=$(this).val();if(h&&h!="0"){const f=$(this).closest("div").find("input.assessment-type-input").val().trim(),b=$(this).closest(m).length>0;s.push({assessmentType:f,term:p,percentage:h,isExamination:b})}})}s.forEach((r,p)=>{l.append(`grading[${p}][assessmentType]`,r.assessmentType),l.append(`grading[${p}][term]`,r.term),l.append(`grading[${p}][percentage]`,r.percentage),l.append(`grading[${p}][isExamination]`,r.isExamination)}),$("#loader-modal-create").removeClass("hidden"),$("body").addClass("no-scroll"),$.ajax({url:"/insert-classrecord",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",data:l,contentType:!1,processData:!1,success:function(r){r.success?setTimeout(function(){Swal.fire({title:"Success!",text:r.message,icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{window.location.href=r.redirect_url})},500):Swal.fire({title:"Error!",text:r.message,icon:"error",confirmButtonText:"OK"})},error:function(r,p,g){Swal.fire({title:"Error!",text:"An error occurred: "+g,icon:"error",confirmButtonText:"OK"})},complete:function(){$("#loader-modal-create").addClass("hidden"),$("body").removeClass("no-scroll")}})});function e(u){let n=0;return $(u).each(function(){n+=parseFloat($(this).val())||0}),n}function c(){let u=[];return $(".day-row").each(function(){const n=$(this).find(".day-container");if(n.hasClass("bg-red-900")){const t=n.val(),a=$(this).find('.time-inputs input[type="time"]');let d=[];for(let l=0;l<a.length;l+=2){const o=$(a[l]).val(),s=$(a[l+1]).val();o&&s&&d.push(`${o}-${s}`)}d.length>0&&u.push({day:t,time:d.join(" / ")})}}),u}});document.addEventListener("DOMContentLoaded",function(){document.getElementById("next-btn").addEventListener("click",function(c){c.preventDefault();const u=document.querySelectorAll("#classrecord-information [required]:not(:disabled)");let n=!0,t=[];u.forEach(l=>{l.value?l.classList.remove("border-red-500"):(n=!1,l.classList.add("border-red-500"),t.push(l.previousElementSibling.textContent.replace("*","").trim()))});const a=document.getElementById("course-select");a.value===""||a.value==="Select Course"?(n=!1,a.classList.add("border-red-500"),t.push("Course")):a.classList.remove("border-red-500");const d=document.querySelectorAll(".day-container.bg-red-900");if(d.length===0&&(n=!1,t.push("At least one day must be selected")),d.forEach(l=>{const o=l.closest(".day-row"),s=o.querySelector(".start-time"),i=o.querySelector(".end-time");!s.value||!i.value?(n=!1,s.classList.add("border-red-500"),i.classList.add("border-red-500"),t.push(`${l.textContent.trim()} times`)):(s.classList.remove("border-red-500"),i.classList.remove("border-red-500"))}),n){document.querySelector('[data-step="1"] .step-number');const l=document.querySelector('[data-step="2"] .step-number'),o=document.querySelector(".step-border");o.classList.remove("bg-gray-200"),o.classList.add("bg-red-900"),l.classList.remove("bg-gray-300","text-gray-500"),l.classList.add("bg-red-900","text-white"),document.getElementById("grade-distribution").classList.remove("hidden"),document.getElementById("grade-config-next-btn").classList.remove("hidden"),document.getElementById("grade-config-back-btn").classList.remove("hidden"),document.getElementById("classrecord-information").classList.add("hidden"),document.getElementById("next-btn").classList.add("hidden")}else Swal.fire({title:"Incomplete Form",html:`Please address the following:<br><br>${t.join("<br>")}`,icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#dc2626"})})});function P(){const e=document.querySelectorAll("#edit-classrecord-information [required]:not(:disabled)");let c=!0,u=[];e.forEach(a=>{a.value?a.classList.remove("border-red-500"):(c=!1,a.classList.add("border-red-500"),u.push(a.previousElementSibling.textContent.replace("*","").trim()))});const n=document.getElementById("edit-course-select");!n.value||n.value==="Select Course"?(c=!1,n.classList.add("border-red-500"),u.push("Course")):n.classList.remove("border-red-500");const t=document.querySelectorAll(".edit-day-row .edit-day-container.bg-red-900");if(t.length===0&&(c=!1,u.push("At least one day must be selected")),t.forEach(a=>{const l=a.closest(".edit-day-row").querySelectorAll('.edit-time-inputs input[type="time"]');!l[0].value||!l[1].value?(c=!1,l.forEach(o=>{o.classList.add("border-red-500")}),u.push(`${a.value.trim()} times`)):l.forEach(o=>{o.classList.remove("border-red-500")})}),c){let a;if(typeof window.recordType<"u"&&window.recordType!==null)a=window.recordType.toString(),$(".assessment-cs, .assessment-exam, .assessment-cs-final, .assessment-exam-final, .assessment-cs-special, .assessment-exam-special").each(function(){const d=$(this).find("input").val();(!d||parseInt(d)===0)&&$(this).remove()}),$("#checkbox-container").addClass("hidden"),$(".new-assessment-cs, .new-assessment-exam, .new-assessment-exam-final, .new-assessment-cs-final, .new-assessment-cs-special, .new-assessment-exam-special").addClass("hidden");else{if(a=$("#edit-grading-period").val(),$("#edit-grading-period").prop("disabled",!1),a==null||a==="")return;a=a.toString(),$(".assessment-cs").each(function(){const d=$(this).find("p").text().replace(":","").trim();$(this).replaceWith(`
                    <div class="flex items-center space-x-1 mb-2 gap-2">
                        <input type="text" class="assessment-type-input md:w-1/3 w-1/2 border-b border-black focus:outline-none text-black pl-2" value="${d}">
                        <span>:</span>
                        <input type="number" class="text-center border-b border-black focus:outline-none w-20 text-black edit-grade-input class-standing-input" min="0" max="100" value="0">
                        <span>%</span>
                    </div>
                `)}),$(".assessment-exam").each(function(){const d=$(this).find("p").text().replace(":","").trim();$(this).replaceWith(`
                    <div class="flex items-center space-x-1 mb-2 gap-2">
                        <input type="text" class="assessment-type-input md:w-1/3 w-1/2 border-b border-black focus:outline-none text-black pl-2" value="${d}">
                        <span>:</span>
                        <input type="number" class="text-center border-b border-black focus:outline-none w-20 edit-grade-input examination-input text-black" min="0" max="100" value="0">
                        <span>%</span>
                    </div>
                `)}),$(".assessment-cs-final").each(function(){const d=$(this).find("p").text().replace(":","").trim();$(this).replaceWith(`
                    <div class="flex items-center space-x-1 mb-2 gap-2">
                        <input type="text" class="assessment-type-input md:w-1/3 w-1/2 border-b border-black focus:outline-none text-black pl-2" value="${d}">
                        <span>:</span>
                        <input type="number" class="text-center border-b border-black focus:outline-none w-20 edit-grade-input-finals edit-final-class-standing-input text-black" min="0" max="100" value="0">
                        <span>%</span>
                    </div>
                `)}),$(".assessment-exam-final").each(function(){const d=$(this).find("p").text().replace(":","").trim();$(this).replaceWith(`
                    <div class="flex items-center space-x-1 mb-2 gap-2">
                        <input type="text" class="assessment-type-input md:w-1/3 w-1/2 border-b border-black focus:outline-none text-black pl-2" value="${d}">
                        <span>:</span>
                        <input type="number" class="text-center border-b border-black focus:outline-none w-20 edit-grade-input-finals edit-final-examination-input examination-input text-black" min="0" max="100" value="0">
                        <span>%</span>
                    </div>
                `)}),$(".assessment-exam-special").each(function(){const d=$(this).find("p").text().replace(":","").trim();$(this).replaceWith(`
                    <div class="flex items-center space-x-1 mb-2 gap-2">
                        <input type="text" class="assessment-type-input md:w-1/3 w-1/2 border-b border-black focus:outline-none text-black pl-2" value="${d}">
                        <span>:</span>
                        <input type="number" class="text-center border-b border-black focus:outline-none w-20 edit-grade-input-special edit-special-examination-input examination-input text-black" min="0" max="100" value="0">
                        <span>%</span>
                    </div>
                `)}),$(".assessment-cs-special").each(function(){const d=$(this).find("p").text().replace(":","").trim();$(this).replaceWith(`
                    <div class="flex items-center space-x-1 mb-2 gap-2">
                        <input type="text" class="assessment-type-input md:w-1/3 w-1/2 border-b border-black focus:outline-none text-black pl-2" value="${d}">
                        <span>:</span>
                        <input type="number" class="text-center border-b border-black focus:outline-none w-20 edit-grade-input-special edit-special-class-standing-input text-black" min="0" max="100" value="0">
                        <span>%</span>
                    </div>
                `)}),$("#edit-class-standing-percentage").val(70),$("#edit-examination-percentage").val(30),$("#edit-final-class-standing-percentage").val(70),$("#edit-final-examination-percentage").val(30),$("#edit-special-class-standing-percentage").val(70),$("#edit-special-examination-percentage").val(30)}$("#edit-first-grading, #edit-second-grading, #edit-third-grading").addClass("hidden"),$("#edit-grading-period-1, #edit-grading-period-2, #edit-grading-period-3").addClass("hidden"),$("#edit-classrecord-information").addClass("hidden"),a==="1"?($("#edit-grade-distribution").removeClass("hidden"),$("#edit-first-grading").removeClass("hidden"),$("#edit-grading-period-1").removeClass("hidden"),$("#edit-next-btn").addClass("hidden")):a==="2"?($("#edit-grade-distribution").removeClass("hidden"),$("#edit-first-grading, #edit-second-grading").removeClass("hidden"),$("#edit-grading-period-1, #edit-grading-period-2").removeClass("hidden"),$("#edit-next-btn").addClass("hidden")):a==="3"&&($("#edit-grade-distribution").removeClass("hidden"),$("#edit-first-grading, #edit-second-grading, #edit-third-grading").removeClass("hidden"),$("#edit-grading-period-1, #edit-grading-period-2, #edit-grading-period-3").removeClass("hidden"),$("#edit-next-btn").addClass("hidden"))}else Swal.fire({title:"Incomplete Form",html:`Please address the following:<br><br>${u.join("<br>")}`,icon:"warning",confirmButtonText:"OK",confirmButtonColor:"#dc2626"});return c}$(document).ready(function(){$(document).on("click",".edit-btn",function(){var e=$(this).data("class-record-id");window.location.href=`update-class-record/${e}`})});document.addEventListener("DOMContentLoaded",function(){document.getElementById("edit-next-btn").addEventListener("click",function(c){c.preventDefault(),P(),document.querySelector('[data-step="1"] .step-number');const u=document.querySelector('[data-step="2"] .step-number'),n=document.querySelector(".step-border");n.classList.remove("bg-gray-200"),n.classList.add("bg-red-900"),u.classList.remove("bg-gray-300","text-gray-500"),u.classList.add("bg-red-900","text-white"),$("#edit-grade-config-back-btn").removeClass("hidden"),$("#edit-grade-config-next-btn").removeClass("hidden")})});$(document).ready(function(){let e=null;$(document).on("click",".edit-btn",function(u){e=$(this).data("class-record-id"),$("#edit-submit-btn, #special-edit-submit-btn").data("class-record-id",e)}),$("#edit-submit-btn, #special-edit-submit-btn").on("click",function(u){u.preventDefault();function n(){const b=window.location.href.split("/");return b[b.length-1]}const t=n();if(t===null){console.error("Class Record ID is missing"),Swal.fire({title:"Error",text:"Class Record ID is missing",icon:"error",confirmButtonText:"OK"});return}const a=$("#edit-grading-period").val(),d=new FormData;let l=0,o=0,s=0;const i=[];if(a==="1"){if(l=c(".edit-first-grade-distribution-input"),l!==100){Swal.fire({title:"Invalid Grading Distribution",html:`The total percentage for Midterm must be 100%.<br><br>
                           Current total: ${l}%`,icon:"error",confirmButtonText:"OK"});return}i.push({gradingDistributionType:$(".edit-first-grade-type-input").val(),gradingDistributionPercentage:l,term:1})}else if(a==="2"){if(l=c(".edit-first-grade-distribution-input"),o=c(".edit-second-grade-distribution-input"),l+o!==100){Swal.fire({title:"Invalid Grading Distribution",html:`The total percentage for Midterm and Finals must be 100%.<br><br>
                           Current totals:<br>
                           Midterm: ${l}%<br>
                           Finals: ${o}%`,icon:"error",confirmButtonText:"OK"});return}i.push({gradingDistributionType:$(".edit-first-grade-type-input").val(),gradingDistributionPercentage:l,term:1},{gradingDistributionType:$(".edit-second-grade-type-input").val(),gradingDistributionPercentage:o,term:2})}else if(a==="3"){if(l=c(".edit-first-grade-distribution-input"),o=c(".edit-second-grade-distribution-input"),s=c(".edit-third-grade-distribution-input"),l+o+s!==100){Swal.fire({title:"Invalid Grading Distribution",html:`The total percentage for Midterm, Finals, and Special must be 100%.<br><br>
                           Current totals:<br>
                           Midterm: ${l}%<br>
                           Finals: ${o}%<br>
                           Special: ${s}%`,icon:"error",confirmButtonText:"OK"});return}i.push({gradingDistributionType:$(".edit-first-grade-type-input").val(),gradingDistributionPercentage:l,term:1},{gradingDistributionType:$(".edit-second-grade-type-input").val(),gradingDistributionPercentage:o,term:2},{gradingDistributionType:$(".edit-third-grade-type-input").val(),gradingDistributionPercentage:s,term:3})}i.forEach((f,b)=>{d.append(`gradingDistributions[${b}][gradingDistributionType]`,f.gradingDistributionType),d.append(`gradingDistributions[${b}][gradingDistributionPercentage]`,f.gradingDistributionPercentage),d.append(`gradingDistributions[${b}][term]`,f.term)});const r=[];$(".edit-day-row").each(function(){const f=$(this).find(".edit-day-container");if(f.hasClass("bg-red-900")){const b=f.val(),v=$(this).find('.edit-time-inputs input[type="time"]');let C=[];for(let w=0;w<v.length;w+=2){const y=v[w].value,L=v[w+1].value;y&&L&&C.push(`${y}-${L}`)}C.length>0&&r.push({day:b,times:C})}}),d.append("schoolYear",$("#edit-academic-year").val()),d.append("schedules",JSON.stringify(r)),d.append("semester",$("#edit-semester").val()),d.append("yearLevel",$("#edit-year-level").val()),d.append("recordType",a),d.append("branch",$("#edit-branch-select").val()),d.append("programID",$("#edit-program-select").val()),d.append("courseID",$("#edit-course-select").val());const p=[];if(a==="1"){if(c(".edit-grade-input")!==100){Swal.fire({title:"Error!",text:"total percentage must equal 100%.",icon:"error",confirmButtonText:"OK"});return}g(".edit-grade-input",1,"#edit-class-standing-container","#edit-examination-container")}else if(a==="2"){const f=c(".edit-grade-input"),b=c(".edit-grade-input-finals");if(f!==100||b!==100){Swal.fire({title:"Error!",text:"total percentages must equal 100%.",icon:"error",confirmButtonText:"OK"});return}g(".edit-grade-input",1,"#edit-class-standing-container","#edit-examination-container"),g(".edit-grade-input-finals",2,"#edit-final-class-standing-container","#edit-final-examination-container")}else if(a==="3"){const f=c(".edit-grade-input"),b=c(".edit-grade-input-finals"),v=c(".edit-grade-input-special");if(f!==100||b!==100||v!==100){Swal.fire({title:"Error!",text:"total percentages must equal 100%.",icon:"error",confirmButtonText:"OK"});return}g(".edit-grade-input",1,"#edit-class-standing-container","#edit-examination-container"),g(".edit-grade-input-finals",2,"#edit-final-class-standing-container","#edit-final-examination-container"),g(".edit-grade-input-special",3,"#edit-special-class-standing-container","#edit-special-examination-container")}function g(f,b,v,C){$(f).each(function(){const w=$(this).val();if(w&&w!=="0"){const y=$(this).closest("div").find("input.assessment-type-input").val()||$(this).closest("div").find("p").text().replace(":","").trim(),L=$(this).closest(C).length>0;p.push({assessmentType:y,term:b,percentage:w,isExamination:L})}})}p.forEach((f,b)=>{d.append(`grading[${b}][assessmentType]`,f.assessmentType),d.append(`grading[${b}][term]`,f.term),d.append(`grading[${b}][percentage]`,f.percentage),d.append(`grading[${b}][isExamination]`,f.isExamination)});const m=$("#edit-image-upload")[0].files[0];m&&d.append("classImg",m);const h=$('meta[name="csrf-token"]').attr("content");$("#loader-modal-update").removeClass("hidden"),$("body").addClass("no-scroll"),$.ajax({url:`/update-class-record/${t}`,method:"POST",data:d,contentType:!1,processData:!1,headers:{"X-CSRF-TOKEN":h,"X-HTTP-Method-Override":"PUT"},success:function(f){Swal.fire({title:"Success!",text:f.message,icon:"success",timer:2e3,showConfirmButton:!1}).then(()=>{window.location.href=f.redirect_url})},error:function(f){console.error(f.responseJSON.errors),Swal.fire({title:"Error",text:f.responseJSON.errors?Object.values(f.responseJSON.errors).flat().join(`
`):"An error occurred while updating the class record.",icon:"error",confirmButtonText:"OK"})},complete:function(){$("#loader-modal-update").addClass("hidden"),$("body").removeClass("no-scroll")}})});function c(u){let n=0;return $(u).each(function(){n+=parseFloat($(this).val())||0}),n}});document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("grading-period"),c=document.getElementById("edit-grading-period"),u=document.getElementById("stepper");function n(d){u.innerHTML="";for(let l=1;l<=d+2;l++){const o=document.createElement("div");o.className="step-container flex items-center";const s=document.createElement("div");s.className="step z-20",s.setAttribute("data-step",l);const i=document.createElement("div");if(i.className=`step-number flex justify-center items-center md:w-8 md:h-8 h-7 w-7 rounded-full ${l===1?"bg-red-900 text-white":"bg-gray-300 text-gray-500"} font-bold transition-all duration-300`,i.textContent=l,s.appendChild(i),o.appendChild(s),u.appendChild(o),l<d+2){const r=document.createElement("div");r.className="step-border md:w-14 w-7 h-2 z-10 bg-gray-200 transition-all duration-300",o.appendChild(r)}}}function t(d){const l=parseInt(d.value);l?n(l):u.innerHTML=""}function a(d){if(d){const l=parseInt(d.value);l&&n(l),d.addEventListener("change",function(){t(this)})}}a(e),c&&$(document).ajaxComplete(function(d,l,o){o.url.includes("/get-grading-distribution/")&&($("#edit-grading-period").val(),a(c),$("#edit-grading-period").trigger("change"))})});$(document).ready(function(){function e(){const t=window.location.href.split("/");return t[t.length-1]}const c=e();$("#edit-classrecord-information").removeClass("hidden"),$("#edit-normal-grade-configuration").addClass("hidden"),$.ajax({url:"/get-class-record",method:"POST",data:{id:c},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(n){function t(s){$.ajax({url:"/get-branches",method:"GET",success:function(i){const r=$("#edit-branch-select");r.empty().append('<option value="">Select Branch</option>'),Array.isArray(i.branches)?(i.branches.forEach(function(p){r.append(`<option value="${p.branchID}">${p.branchDescription}</option>`)}),s&&r.val(s).change()):console.error("Unexpected branches data format:",i.branches)},error:function(i){console.error("Error fetching branches:",i)}})}n.branch&&n.branch.branchID&&t(n.branch.branchID),n.program&&n.program.programID&&$("#edit-program-select").val(n.program.programID),n.course&&n.course.courseID&&$("#edit-course-select").val(n.course.courseID);function a(s){$.ajax({url:`/get-program/${s}`,method:"GET",success:function(i){const r=$("#edit-program-select");r.empty().append('<option value="">Select Program</option>'),Array.isArray(i.programs)?(i.programs.forEach(function(p){r.append(`<option value="${p.programID}">${p.programTitle}</option>`)}),n.program&&n.program.programID&&r.val(n.program.programID),r.trigger("change")):console.error("Unexpected programs data format:",i.programs)},error:function(i){console.error("Error fetching programs:",i)}})}function d(s){$.ajax({url:`/get-courses/${s}`,method:"GET",success:function(i){const r=$("#edit-course-select");if(r.empty().append('<option value="">Select Course</option>'),Array.isArray(i.courses)){if(i.courses.forEach(function(p){r.append(`<option value="${p.courseID}" data-course-code="${p.courseCode}">${p.courseTitle}</option>`)}),n.course&&n.course.courseID){r.val(n.course.courseID);const p=r.find(":selected").data("course-code");$("#edit-course-description").text(p||"Select a course")}}else console.warn("No courses data available for the selected program")},error:function(i){console.error("Error fetching courses:",i)}})}$("#edit-course-select").on("change",function(){const i=$(this).find(":selected").data("course-code");$("#edit-course-description").text(i||"Select a course")}),n.branch&&n.branch.branchID&&a(n.branch.branchID),$("#edit-branch-select").on("change",function(){const s=$(this).val();$("#edit-course-select").empty().append('<option value="">Select Course</option>'),s&&a(s)}),$("#edit-program-select").on("change",function(){const s=$(this).val();$("#edit-course-select").empty().append('<option value="">Select Course</option>'),s&&d(s)}),$("#edit-year-level").val(n.yearLevel),$("#edit-academic-year").val(n.schoolYear),$("#edit-semester").val(n.semester),$("#edit-sched-time").val(n.schedTime),n.classImgUrl?$("#edit-image-preview").attr("src",n.classImgUrl):$("#edit-image-preview").attr("src","https://via.placeholder.com/150"),$("#edit-sched-day").val(n.schedDay);const l=n.recordType;window.recordType=l,l==null||l===""?($("#edit-grading-period").prop("disabled",!1),$("#edit-grading-period").css("border","2px solid red")):($("#edit-grading-period").css("border",""),$("#edit-grading-period").css("background-color","")),$("#edit-grading-period").on("change",function(){$(this).val()&&($(this).css("border",""),$(this).css("background-color",""))}),$.ajax({url:`/get-class-record-grading/${c}`,method:"GET",success:function(s){Array.isArray(s)?(s.forEach(function(i){let r,p,g;if(i.term===1?(r=$("#edit-midterm-grade"),p="edit-grade-input"):i.term===2?(r=$("#edit-final-grade"),p="edit-grade-input-finals"):i.term===3&&(r=$("#edit-special-grade"),p="edit-grade-input-special"),r&&r.length){i.isExamination?(g=r.find("[id$='examination-container']"),p+=" examination-input"):g=r.find("[id$='class-standing-container']");let m=g.find(`p:contains("${i.assessmentType}")`).closest("div").find("input");if(m.length)m.val(o(i.percentage)),i.isExamination?m.addClass("examination-input"):m.removeClass("examination-input"),m.trigger("input");else{let h=`
                                            <div class="flex items-center space-x-1 mb-2">
                                                <p class="md:w-1/3 w-1/2">${i.assessmentType}:</p>
                                                <input type="number" class="text-center border-b border-black focus:outline-none w-20 ${p}" min="0" max="100" value="${o(i.percentage)}">
                                            <span>%</span>
                                            </div>
                                        `;g.append(h),g.find("input").last().trigger("input")}}else console.error("Container not found for term:",i.term)}),typeof S=="function"?S("edit-",!1,!0):console.error("updateTotal function is not defined"),typeof T=="function"?T("edit-",!1,!0):console.error("updateFinalTotal function is not defined"),typeof E=="function"?E("edit-",!1,!0):console.error("updateFinalTotal function is not defined")):console.error("Grading data is not an array:",s),k("edit-",!0),D("edit-",!0),B("edit-",!0)},error:function(s){console.error("Error fetching grading data:",s)}});function o(s){return s%1===0?parseInt(s):s.toFixed(2)}$.ajax({url:`/get-grading-distribution/${c}`,method:"GET",success:function(s){$("#edit-grading-period").val(n.recordType),$("#edit-grading-period").trigger("change"),Array.isArray(s)?(s.forEach(function(i){const r=o(i.gradingDistributionPercentage);i.term===1?($(".edit-first-grade-type-input").val(i.gradingDistributionType),$(".edit-first-grade-distribution-input").val(r)):i.term===2?($(".edit-second-grade-type-input").val(i.gradingDistributionType),$(".edit-second-grade-distribution-input").val(r)):i.term===3&&($(".edit-third-grade-type-input").val(i.gradingDistributionType),$(".edit-third-grade-distribution-input").val(r))}),I(!0)):console.error("Expected an array of grading distribution data but got:",s)},error:function(s){console.error("Error fetching grading distribution data:",s)}}),$.ajax({url:`/get-schedule/${c}`,method:"GET",success:function(s){s.success&&s.schedules?u(s.schedules):console.error("Error fetching schedule data:",s.message)},error:function(s){console.error("Error fetching schedule:",s)}}),$("#update-modal").removeClass("hidden")},error:function(n){console.error("Error fetching class record:",n)}});function u(n){n.forEach(t=>{t.scheduleTime.split(" / ").forEach((d,l)=>{let o;o=$(".edit-day-row").filter(function(){return $(this).find(".edit-day-container").val()===t.scheduleDay}),o.length===0&&($(".edit-add-schedule-button").before(`
                        <div class="edit-day-row flex flex-col gap-2 mb-2">
                            <div class=" edit-day-row flex md:flex-row flex-col gap-5 items-center -mb-2">
                                                        <div class="flex gap-2 flex-col">
            
                                                            <select name="" id=""
                                                                class="edit-day-container bg-red-900 flex flex-col gap-2 rounded-2xl p-2 shadow-md border border-gray-300  day-container text-gray-700">
                                                                <option value="">Select Day</option>
                                                                <option value="Monday">Monday</option>
                                                                <option value="Tuesday">Tuesday</option>
                                                                <option value="Wednesday">Wednesday</option>
                                                                <option value="Thursday">Thursday</option>
                                                                <option value="Friday">Friday</option>
                                                                <option value="Saturday">Saturday</option>
                                                                <option value="Sunday">Sunday</option>
                                                            </select>
                                                        </div>

                                                        <div class="flex gap-2 flex-col">
                                                         
                                                            <div class="flex flex-row gap-2 px-4">
                                                                <div class="edit-time-inputs flex flex-col md:gap-2 gap-1 ">
                                                                    <div class="flex md:gap-2 gap-1">
                                                                        <input type="time"
                                                                            class="edit-start-time border border-gray-300 rounded-2xl md:p-2 p-2  md:w-full w-24 text-gray-700"
                                                                            required >
                                                                        <span class="self-center">to</span>
                                                                        <input type="time"
                                                                            class="edit-end-time border border-gray-300 rounded-2xl md:p-2 p-2 md:w-full w-24 text-gray-700"
                                                                            required >
                                                                    </div>
                                                                </div>
                                                                <div class="flex justify-center items-center">
                                                                    <i
                                                                        class="edit-add-time  fa-solid fa-plus cursor-pointer text-gray-400 text-lg dark:text-[#CCAA2C] bg-white p-1 rounded-md shadow-lg border border-gray-300 hover:bg-gray-100 dark:hover:bg-[#1E1E1E]"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                        </div>
                    `),o=$(".edit-day-row").last()),o.find(".edit-day-container").val(t.scheduleDay).addClass("bg-red-900 text-white"),l>0&&o.find(".edit-time-inputs").append(`
                        <div class="flex gap-2">
                            <input type="time" class="edit-start-time border border-gray-300 rounded-2xl md:p-2 p-2  md:w-full w-24" required>
                            <span class="self-center">to</span>
                            <input type="time" class="edit-end-time border border-gray-300 rounded-2xl md:p-2 p-2  md:w-full w-24" required>
                        </div>
                    `);const[i,r]=d.split("-");o.find(".edit-time-inputs .edit-start-time").last().val(i),o.find(".edit-time-inputs .edit-end-time").last().val(r)})})}});$(document).ready(function(){$(document).on("change",".day-container, .edit-day-container",function(){const e=$(this).closest(".day-row, .edit-day-row"),c=e.find('input[type="time"]'),u=e.find(".add-time, .edit-add-time");$(this).val()?($(this).addClass("bg-red-900 text-white").removeClass("bg-white text-black"),c.prop("disabled",!1),u.removeClass("disabled")):($(this).removeClass("bg-red-900 text-white").addClass("bg-white text-black"),c.prop("disabled",!0).val(""),u.addClass("disabled"))}),$(document).on("click",".add-time:not(.disabled), .edit-add-time:not(.disabled), .remove-time",function(){const e=$(this).closest(".day-row, .edit-day-row"),c=e.find(".time-inputs, .edit-time-inputs");if(!e.find(".day-container, .edit-day-container").val()){Swal.fire({icon:"error",title:"No Day Selected",text:"Please select a day before adding or removing a time."});return}if($(this).hasClass("add-time")||$(this).hasClass("edit-add-time")){if(c.find(".time-row").length>0){Swal.fire({icon:"warning",title:"Limit Reached",text:"You can only add time once for this day."});return}c.append(`
                <div class="flex gap-2 mt-2 time-row">
                    <input type="time" class="start-time border border-gray-300 rounded-2xl md:p-2 p-2  md:w-full w-24" required >
                    <span class="self-center">to</span>
                    <input type="time" class="end-time border border-gray-300 rounded-2xl md:p-2 p-2 md:w-full w-24" required>
                </div>
            `),$(this).removeClass("add-time fa-plus edit-add-time").addClass("remove-time fa-minus").attr("title","Remove Time")}else if($(this).hasClass("remove-time")){const n=c.find(".time-row");n.length>0&&(n.remove(),$(this).removeClass("remove-time fa-minus").addClass("add-time fa-plus").attr("title","Add Time"))}}),$(document).on("click",".add-schedule-button, .edit-add-schedule-button",function(){$(this).hasClass("edit-add-schedule-button")?$(this).before(`
            <div class="edit-day-row flex flex-col gap-2 mb-2">
                                                    <div class="flex md:flex-row flex-col gap-5 items-center -mb-2">
                                                        <div class="flex gap-2 flex-col">
                                                    
                                                            <select name="" id=""
                                                                class="edit-day-container flex flex-col gap-2 rounded-2xl p-2 shadow-md border border-gray-300  day-container text-gray-700">
                                                                <option value="">Select Day</option>
                                                                <option value="Monday">Monday</option>
                                                                <option value="Tuesday">Tuesday</option>
                                                                <option value="Wednesday">Wednesday</option>
                                                                <option value="Thursday">Thursday</option>
                                                                <option value="Friday">Friday</option>
                                                                <option value="Saturday">Saturday</option>
                                                                <option value="Sunday">Sunday</option>
                                                            </select>
                                                        </div>

                                                        <div class="flex gap-2 flex-col">
                                
                                                            <div class="flex flex-row gap-2 px-4">
                                                                <div class="edit-time-inputs flex flex-col md:gap-2 gap-1 text-gray-700">
                                                                    <div class="flex md:gap-2 gap-1">
                                                                        <input type="time"
                                                                            class="edit-start-time border border-gray-300 rounded-2xl p-2  md:w-full w-24"
                                                                            required disabled>
                                                                        <span class="self-center">to</span>
                                                                        <input type="time"
                                                                            class="edit-end-time border border-gray-300 rounded-2xl p-2  md:w-full w-24"
                                                                            required disabled>
                                                                    </div>
                                                                </div>
                                                                <div class="flex justify-center items-center">
                                                                    <i
                                                                        class="edit-add-time fa-solid fa-plus cursor-pointer text-gray-400 text-lg dark:text-[#CCAA2C] bg-white p-1 rounded-md shadow-lg border border-gray-300 hover:bg-gray-200"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
            
            `):$(this).before(`
            <div class="day-row flex flex-col gap-2 mb-2">
                                                    <div class="flex md:flex-row flex-col gap-5 items-center -mb-2">
                                                        <div class="flex gap-2 flex-col">
                                                            <div class="inline sm:hidden">
                                                                <div class="flex items-center justify-center font-bold  ">
                                                                    <span>Day</span>
                                                            </div>
                                                            </div>
                                                            <select name="" id=""
                                                                class="flex flex-col gap-2 rounded-2xl p-2 shadow-md border border-gray-300  day-container text-gray-700">
                                                                <option value="">Select Day</option>
                                                                <option value="Monday">Monday</option>
                                                                <option value="Tuesday">Tuesday</option>
                                                                <option value="Wednesday">Wednesday</option>
                                                                <option value="Thursday">Thursday</option>
                                                                <option value="Friday">Friday</option>
                                                                <option value="Saturday">Saturday</option>
                                                                <option value="Sunday">Sunday</option>
                                                            </select>
                                                        </div>

                                                        <div class="flex gap-2 flex-col">
                                                            <div class="inline sm:hidden">
                                                                <div class="flex items-center justify-center font-bold ">
                                                                    <span>Time</span>
                                                            </div>
                                                            </div>
                                                            <div class="flex flex-row gap-2 px-4">
                                                                <div class="time-inputs flex flex-col md:gap-2 gap-1 ">
                                                                    <div class="flex md:gap-2 gap-1">
                                                                        <input type="time"
                                                                            class="start-time border border-gray-300 rounded-2xl p-2  md:w-full w-24 text-gray-700"
                                                                            required disabled>
                                                                        <span class="self-center">to</span>
                                                                        <input type="time"
                                                                            class="end-time border border-gray-300 rounded-2xl p-2  md:w-full w-24 text-gray-700"
                                                                            required disabled>
                                                                    </div>
                                                                </div>
                                                                <div class="flex justify-center items-center">
                                                                    <i
                                                                        class="add-time fa-solid fa-plus cursor-pointer text-gray-400 text-lg dark:text-[#CCAA2C] bg-white p-1 rounded-md shadow-lg border border-gray-300"></i>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>`)})});$(document).ready(function(){function e(){var c=$("#academic-year").val(),u=$("#semester").val(),n=0,t=0;$(".record-item").each(function(){var a=$(this).data("school-year"),d=$(this).data("semester");(c===""||c==a)&&(u===""||u==d)?($(this).show(),n++):$(this).hide()}),$(".record-item").each(function(){var a=$(this).data("school-year"),d=$(this).data("semester");(c===""||c==a)&&(u===""||u==d)?($(this).show(),t++):$(this).hide()}),n===0&&t===0?($("#no-record-message").show(),$("#new-class-record").hide()):($("#no-record-message").hide(),$("#new-class-record").show())}$("#academic-year, #semester").on("change",function(){e()}),e()});$(document).on("click",".archive-btn",function(){const e=$(this).data("class-record-id"),c=$(this).data("course-title"),u=$(this).data("program-title");Swal.fire({title:"Confirmation",html:`
        <p>Do you want to archive this class record: <strong>${c} (${u})</strong>?</p>
        <p><strong><small style="color: #d33;">This record will be marked as archived. You cannot modify, add, or edit it once archived.</small></strong></p>
    `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(n=>{n.isConfirmed&&$.ajax({url:"/archive-record",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{classRecordID:e},success:function(t){t.success?Swal.fire("Archived!",t.message,"success").then(()=>{location.reload()}):Swal.fire("Error!",t.message,"error")},error:function(t){var d;const a=((d=t.responseJSON)==null?void 0:d.message)||"An error occurred while processing your request.";Swal.fire("Warning!",a,"warning")}})})});$(document).ready(function(){$(".record-item").on("click",function(e){e.preventDefault();var c=$(this).data("record-type"),u=$(this).find("input[name='classRecordID']").val();if(!c)Swal.fire({icon:"warning",title:"Incomplete Record",text:"The grade configuration for this class record is missing. Please update it before proceeding.",allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"Go to Update"}).then(n=>{n.isConfirmed&&(window.location.href=`update-class-record/${u}`)});else{if($(e.target).closest(".modify-btn").length>0||$(e.target).closest(".fa-box-archive").length>0)return;$(this).find("form").submit()}})});
