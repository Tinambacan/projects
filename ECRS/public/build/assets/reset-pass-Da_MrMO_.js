$(document).ready(function(){$(".toggle-password").click(function(){$(this).toggleClass("fa-eye fa-eye-slash");var r=$($(this).attr("toggle"));r.attr("type")=="password"?r.attr("type","text"):r.attr("type","password")}),$("#submit-btn").on("click",function(r){r.preventDefault();var n=$("#email").val(),t=$(this).closest("form")[0];$("#send-email-loader-fa").removeClass("hidden"),$("#loader-title").text("Checking"),$.ajax({url:"send-pass-link",method:"POST",data:{email:n,_token:$('meta[name="csrf-token"]').attr("content")},success:function(e){e.success?($("#loader-title").text("Sending to email"),setTimeout(function(){Swal.fire({icon:"success",title:"Success",text:e.message,showConfirmButton:!1,timer:3e3}).then(()=>{t.reset(),$("#send-email-loader-fa").addClass("hidden"),window.location.href=e.redirect})},2e3)):($("#send-email-loader-fa").addClass("hidden"),Swal.fire({icon:"warning",title:"Warning",text:e.message,confirmButtonText:"OK"}).then(()=>{t.reset(),$("#send-email-loader-fa").addClass("hidden")}))},error:function(e){if($("#send-email-loader-fa").addClass("hidden"),e.responseJSON&&e.responseJSON.errors){let s=e.responseJSON.errors;s.email&&(Swal.fire({icon:"error",title:"Oops...",text:s.email[0],confirmButtonText:"Try Again",confirmButtonColor:"#d33"}),t.reset())}else Swal.fire({icon:"error",title:"Something went wrong",text:"Please try again later.",confirmButtonText:"OK",confirmButtonColor:"#d33"}),t.reset()}})}),$("#submit-btn-stud").on("click",function(r){r.preventDefault();var n=$("#email").val(),t=$(this).closest("form")[0];if(!t){console.error("Form not found. Please ensure the button is inside a form.");return}$("#send-email-loader-st").removeClass("hidden"),$("#loader-title").text("Checking"),$.ajax({url:"send-pass-link",method:"POST",data:{email:n,_token:$('meta[name="csrf-token"]').attr("content")},success:function(e){e.success?($("#loader-title").text("Sending to email"),setTimeout(function(){Swal.fire({icon:"success",title:"Success",text:e.message,showConfirmButton:!1,timer:3e3}).then(()=>{t.reset(),$("#send-email-loader-st").addClass("hidden"),window.location.href=e.redirect})},2e3)):($("#send-email-loader-st").addClass("hidden"),Swal.fire({icon:"warning",title:"Warning",text:e.message,confirmButtonText:"OK"}).then(()=>{t.reset(),$("#send-email-loader-st").addClass("hidden")}))},error:function(e){if($("#send-email-loader-st").addClass("hidden"),e.responseJSON&&e.responseJSON.errors){let s=e.responseJSON.errors;s.email&&(Swal.fire({icon:"error",title:"Oops...",text:s.email[0],confirmButtonText:"Try Again",confirmButtonColor:"#d33"}),t.reset())}else Swal.fire({icon:"error",title:"Something went wrong",text:"Please try again later.",confirmButtonText:"OK",confirmButtonColor:"#d33"}),t.reset()}})}),$("#submit-btn-ad").on("click",function(r){r.preventDefault();var n=$("#email").val(),t=$(this).closest("form")[0];if(!t){console.error("Form not found. Please ensure the button is inside a form.");return}$("#send-email-loader-ad").removeClass("hidden"),$("#loader-title").text("Checking"),$.ajax({url:"send-pass-link",method:"POST",data:{email:n,_token:$('meta[name="csrf-token"]').attr("content")},success:function(e){e.success?($("#loader-title").text("Sending to email"),setTimeout(function(){Swal.fire({icon:"success",title:"Success",text:e.message,showConfirmButton:!1,timer:3e3}).then(()=>{t.reset(),$("#send-email-loader-ad").addClass("hidden"),window.location.href=e.redirect})},2e3)):($("#send-email-loader-ad").addClass("hidden"),Swal.fire({icon:"warning",title:"Warning",text:e.message,confirmButtonText:"OK"}).then(()=>{t.reset(),$("#send-email-loader-ad").addClass("hidden")}))},error:function(e){if($("#send-email-loader-ad").addClass("hidden"),e.responseJSON&&e.responseJSON.errors){let s=e.responseJSON.errors;s.email&&(Swal.fire({icon:"error",title:"Oops...",text:s.email[0],confirmButtonText:"Try Again",confirmButtonColor:"#d33"}),t.reset())}else Swal.fire({icon:"error",title:"Something went wrong",text:"Please try again later.",confirmButtonText:"OK",confirmButtonColor:"#d33"}),t.reset()}})})});$(document).ready(function(){const r=$("#token").val(),n=$("#role").val();let t,e;n==1?(t=$("#set-new-pass-btn"),e=`/faculty/reset-password/${r}`):n==2?(t=$("#set-new-pass-btn-ad"),e=`/admin/reset-password/${r}`):(t=$("#set-new-pass-btn-st"),e=`/student/reset-password/${r}`);function s(o){const i=o.length>=8,l=/[A-Z]/.test(o),d=/[!@#$%^&*(),.?":{}|<>]/.test(o),a=/\d/.test(o);return i?$("#length-requirement").css("color","green"):$("#length-requirement").css("color","red"),l?$("#uppercase-requirement").css("color","green"):$("#uppercase-requirement").css("color","red"),d?$("#special-char-requirement").css("color","green"):$("#special-char-requirement").css("color","red"),a?$("#number-requirement").css("color","green"):$("#number-requirement").css("color","red"),i&&l&&d&&a}$("#new-password").on("input",function(){const o=$(this).val();s(o)}),t.on("click",function(o){o.preventDefault();var i=$(this).closest("form")[0];const l=$("#new-password").val(),d=$("#confirm-password").val();if(l!==d){Swal.fire({icon:"error",title:"Passwords do not match",text:"Please make sure the passwords are the same."});return}if(!s(l)){Swal.fire({icon:"error",title:"Invalid Password",text:"Password must be at least 8 characters long, contain one uppercase letter, one number, and one special character."});return}$.ajax({url:e,type:"POST",data:{_token:$("input[name=_token]").val(),newPassword:l,confirmPassword:d},success:function(a){a.success?Swal.fire({icon:"success",title:"Password updated!",text:a.message,confirmButtonText:"OK"}).then(c=>{c.isConfirmed&&(i.reset(),setTimeout(()=>{window.location.href=a.redirect},1e3))}):(Swal.fire({icon:"error",title:"Error",text:a.message||"There was an error updating the password."}),i.reset())},error:function(a){Swal.fire({icon:"error",title:"Error",text:"An error occurred while updating your password. Please try again."}),i.reset()}})})});
