$(document).ready(function(){$("#submit-grades-form").on("submit",function(o){o.preventDefault(),Swal.fire({title:"Submit Grades",text:"Are you sure you want to submit grades?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, submit it!"}).then(n=>{n.isConfirmed&&($("#loader-modal-submit").removeClass("hidden"),$("#loader-title").text("Generating excel"),$("body").addClass("no-scroll"),$.ajax({url:$(this).attr("action"),type:"POST",data:$(this).serialize(),success:function(e){e.success?($("#loader-title").text("Submitting"),setTimeout(function(){Swal.fire({icon:"success",title:"Success",text:e.message,showConfirmButton:!1,timer:2e3}).then(()=>{$("#loader-modal-submit").addClass("hidden"),$("body").removeClass("no-scroll")})},2e3)):Swal.fire({title:"Error!",text:e.message,icon:"error",confirmButtonColor:"#3085d6"})},error:function(e,i,l){Swal.fire({title:"Error!",text:"An error occurred while submitting the grades.",icon:"error",confirmButtonColor:"#3085d6"})}}))})});const s=document.querySelector("#semesterTable");s&&$(s).DataTable({scrollX:!0,pagingType:"simple",paging:!0,order:[]}),$(document).ready(function(){$("#download-excel-btn").on("click",function(o){const n=$(this).data("course-title"),e=$(this).data("program-title"),i=$(this).data("year");o.preventDefault(),Swal.fire({title:"Confirmation",html:`
        <p>Download this excel file for semester grades of class record: <strong>${n} (${e} ${i})</strong>?</p>`,icon:"info",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Download"}).then(l=>{l.isConfirmed&&($("#download-excel").removeClass("hidden"),$.ajax({url:"/export-semester-grade",method:"GET",data:{_token:"{{ csrf_token() }}"},processData:!1,contentType:!1,xhrFields:{responseType:"blob"},success:function(u,f,a){const c=a.getResponseHeader("Content-Disposition");let d="exported-scores.xlsx";if(c){const r=/filename="([^"]*)"/.exec(c);r!=null&&r[1]&&(d=r[1])}const m=new Blob([u],{type:a.getResponseHeader("Content-Type")}),t=document.createElement("a");t.href=window.URL.createObjectURL(m),t.download=d,document.body.appendChild(t),t.click(),document.body.removeChild(t),$("#download-excel").addClass("hidden"),Swal.fire({title:"Success!",text:"Semester grades file successfully downloaded",icon:"success",confirmButtonColor:"#3085d6"})},error:function(){Swal.fire({title:"Error!",text:"Something went wrong while downloading the file",icon:"error",confirmButtonColor:"#d33"})}}))})})})});
