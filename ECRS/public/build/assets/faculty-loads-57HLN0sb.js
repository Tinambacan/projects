document.getElementById("insertJSON").addEventListener("click",async function(){document.getElementById("loader-modal-submit").classList.remove("hidden"),document.getElementById("getJson").classList.remove("hidden"),$("body").addClass("no-scroll");try{const o=await fetch("/fetch-pupt-faculty-schedules",{method:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});if(!o.ok)throw new Error("Network response was not ok");const e=await o.json(),s=await fetch("/store-classrecord-integration",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({pupt_faculty_schedules:e})}),t=await s.json();s.ok?Swal.fire({icon:"success",title:"Success",text:t.message||"Data sent successfully!"}).then(()=>{window.location.reload()}):Swal.fire({icon:"error",title:"Error",text:t.error||"Error occurred while processing your request."}).then(()=>{window.location.reload()})}catch(o){console.error("Error:",o),Swal.fire({icon:"error",title:"Unexpected Error",text:o.message||"An error occurred while processing your request."}).then(()=>{window.location.reload()})}finally{document.getElementById("loader-modal-submit").classList.add("hidden"),document.getElementById("getJson").classList.add("hidden"),$("body").removeClass("no-scroll")}});$(document).ready(function(){const o=document.querySelector("#facultySchedulesTable");o&&$(o).DataTable({responsive:!0,pagingType:"simple",paging:!0,order:[],columnDefs:[{targets:[],orderable:!1}],ajax:{url:"/get-faculty-schedules",method:"GET",dataType:"json",dataSrc:function(e){const s=e.semester,t=e.academic_year_start,n=e.academic_year_end;if(s&&t&&n){let a="N/A";s===1?a="1st Semester":s===2?a="2nd Semester":s===3&&(a="Summer Semester");const r=`${a} SY ${t} - ${n}`;$("#semester-sy-text").text(r)}const c=[];return e.faculties.forEach(a=>{a.schedules.forEach(r=>{c.push({full_name:`${a.first_name} ${a.middle_name||""} ${a.last_name}`,faculty_code:a.faculty_code,program_code:r.program_code,course_title:r.course_details.course_title,course_code:r.course_details.course_code,room_code:r.room_code,day:r.day,start_time:r.start_time,end_time:r.end_time,year_level:r.year_level,section_name:r.section_name})})}),c},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}},columns:[{data:"full_name",className:"text-center",render:e=>e||"N/A"},{data:"faculty_code",className:"text-center",render:e=>e||"N/A"},{data:"course_code",className:"text-center",render:e=>e||"N/A"},{data:"course_title",className:"text-center",render:e=>e||"N/A"},{data:"program_code",className:"text-center",render:e=>e||"N/A"},{data:"day",className:"text-center",render:e=>e||"N/A"},{data:null,className:"text-center",render:(e,s,t)=>{const n=t.start_time||"N/A",c=t.end_time||"N/A";return`${n} - ${c}`}},{data:null,className:"text-center",render:(e,s,t)=>{const n=t.year_level||"N/A",c=t.section_name||"N/A";return`${n} - ${c}`}}]})});
